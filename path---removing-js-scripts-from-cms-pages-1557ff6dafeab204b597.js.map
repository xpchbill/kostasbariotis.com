{"version":3,"sources":["webpack:///path---removing-js-scripts-from-cms-pages-1557ff6dafeab204b597.js","webpack:///./.cache/json/removing-js-scripts-from-cms-pages.json"],"names":["webpackJsonp","624","module","exports","data","file","childImageSharp","sizes","base64","aspectRatio","src","srcSet","srcWebp","srcSetWebp","site","siteMetadata","title","description","siteUrl","markdownRemark","html","excerpt","frontmatter","date","path","tags","draft","pathContext","prev","id","timeToRead","next"],"mappings":"AAAAA,cAAc,gBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,iBAAmBC,OAASC,OAAA,k7BAA0BC,YAAA,kBAAAC,IAAA,4DAAAC,OAAA,yYAAAC,QAAA,6DAAAC,WAAA,+YAAAN,MAAA,qCAAq6DO,MAASC,cAAgBC,MAAA,wBAAAC,YAAA,4LAAAC,QAAA,+BAAkRC,gBAAmBC,KAAA,oroBAAk/nBC,QAAA,8IAAAC,aAA0uCC,KAAA,oBAAAC,KAAA,uCAAAC,KAAA,oDAAAT,MAAA,qCAAAU,MAAA,QAAgMC,aAAgBC,MAAQP,QAAA,6PAAAD,KAAA,m1JAAg2FS,GAAA,wIAAAC,WAAA,EAAAR,aAAkiFC,KAAA,2BAAAC,KAAA,yCAAAC,KAAA,uCAAAT,MAAA,wCAAAU,MAAA,OAA8LK,MAASV,QAAA,8PAAAD,KAAA;AAAk6US,GAAA,6IAAAC,WAAA,EAAAR,aAAs7BC,KAAA,2BAAAC,KAAA,8CAAAC,KAAA,iCAAAT,MAAA,4CAAAU,MAAA","file":"path---removing-js-scripts-from-cms-pages-1557ff6dafeab204b597.js","sourcesContent":["webpackJsonp([15508496722462],{\n\n/***/ 624:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"file\":{\"childImageSharp\":{\"sizes\":{\"base64\":\"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAGQABAQADAQAAAAAAAAAAAAAAAAQBAgUD/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwIB/9oADAMBAAIQAxAAAAGXEfnO2KxXytBY6QBP/8QAGxAAAgIDAQAAAAAAAAAAAAAAAQIDEQASIiH/2gAIAQEAAQUC2qMsrDRjkh7U+9ZIKYC8jNp//8QAFxEBAAMAAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPwFlQ//EABkRAAEFAAAAAAAAAAAAAAAAAAABECExQf/aAAgBAgEBPwGWwWz/xAAbEAACAgMBAAAAAAAAAAAAAAAAEQEhAxAxgf/aAAgBAQAGPwK2dsYo5BBWReaRB//EABwQAAICAwEBAAAAAAAAAAAAAAERACExQVFhcf/aAAgBAQABPyHzg5KmRyuAZAwYJ2aHFOw5Qmlybntx2y3CnEl/Z//aAAwDAQACAAMAAAAQOyi8/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAERMUH/2gAIAQMBAT8QUXCB6YR//8QAGhEAAgIDAAAAAAAAAAAAAAAAAAERMSFBsf/aAAgBAgEBPxByVkzvonYxY//EAB0QAQEAAwACAwAAAAAAAAAAAAERACFBMVFhcbH/2gAIAQEAAT8Q6uhuUW+P3HKhIpbqr8JMNj2KrvBpVoF3uLYUDX3imLRSGt4ck1onhy7wNT0XD24jIs1n/9k=\",\"aspectRatio\":0.9657118055555556,\"src\":\"/static/avatar-820706df6fdb07a9b021a790449fec17-381d6.jpg\",\"srcSet\":\"/static/avatar-820706df6fdb07a9b021a790449fec17-62f05.jpg 200w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-dc2b4.jpg 400w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-381d6.jpg 800w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-e5d70.jpg 1200w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-d14e0.jpg 1600w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-9cc71.jpg 2225w\",\"srcWebp\":\"/static/avatar-820706df6fdb07a9b021a790449fec17-fefde.webp\",\"srcSetWebp\":\"/static/avatar-820706df6fdb07a9b021a790449fec17-5eed2.webp 200w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-68e3c.webp 400w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-fefde.webp 800w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-300fe.webp 1200w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-ed5bd.webp 1600w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-9442a.webp 2225w\",\"sizes\":\"(max-width: 800px) 100vw, 800px\"}}},\"site\":{\"siteMetadata\":{\"title\":\"Kostas Bariotis' Blog\",\"description\":\"I am Kostas Bariotis, a web developer, a proud wanderer and a passionate doer. My mission is to write clean and efficient code, to solve problems on the web and to learn something more.\",\"siteUrl\":\"https://kostasbariotis.com\"}},\"markdownRemark\":{\"html\":\"<p>Magento comes with a lot of Javascript. It uses <a href=\\\"http://prototypejs.org/\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Prototype.js</a>, <a href=\\\"https://github.com/madrobby/scriptaculous\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Scriptaculus</a> and custom libraries written be the Varien people. No doubt that these libraries are old and I hardly use 'em on my themes, but they are very tight to the Magento theme ecosystem and we should be careful when we mess with them.</p>\\n<p>A modern website's home page is very important and we should focus at it's load time a lot. Magento's home page is indeed a CMS page and loads some of those scripts there too.</p>\\n<p>Magento Layout's system has also done a nice job when it comes to what scripts to load where. Something that bothers me is the load of these scripts on CMS pages where by my experience they are not so useful there except from some standard places.</p>\\n<p>So what we do? Say we created our <a href=\\\"http://www.magentocommerce.com/wiki/4_-_themes_and_template_customization/0_-_theming_in_magento/designing-for-magento\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">custom theme</a>. Let's remove those script completely from CMS pages including our home page, which is a CMS page.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-xml\\\"><code><span class=\\\"token prolog\\\">&lt;?xml version=\\\"1.0\\\"?></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>layout</span> <span class=\\\"token attr-name\\\">version</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>0.1.0<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>cms_page</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>reference</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>root<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>reference</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>head<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>prototype/prototype.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>lib/ccard.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>prototype/validation.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/builder.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/effects.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/dragdrop.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/controls.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/slider.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>varien/js.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>varien/form.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>varien/menu.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>mage/translate.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>reference</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>reference</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>cms_page</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>layout</span><span class=\\\"token punctuation\\\">></span></span>\\n</code></pre>\\n      </div>\\n<p>But now we are going to have problems and Dev Console will turn red. Some blocks are not functioning.</p>\\n<p>First the search block on top of our page. It's a form that uses the Validation module and also the Autocomplete feature. Let's remove those by opening the <code>catalogsearch/form.mini.phtml</code> file (after we have copied it on our theme's folder) and remove the <code>&#x3C;script>...&#x3C;/script></code>.</p>\\n<p>We also have the Translator, which translates Javascript strings. We don't going to need it either on our CMS pages. We open <code>page/html/head.phtml</code> and we are removing the <code>&#x3C;?php echo $this->helper('core/js')->getTranslatorScript() ?></code> definition.</p>\\n<p>But that's not all. A lot of widgets that we may have include on our CMS pages, may use some Javascript as well. The new products list widgets, which is located at <code>catalog/product/widget/new/content/new.[list|grid].phtml</code> uses the <code>setLocation</code> function for the Add To Card button. Let's remove that by replacing the button with an anchor. Like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code>&lt;a title=\\\"<span class=\\\"token prolog\\\">&lt;?php echo $this->__('Add to Cart') ?></span>\\\" class=\\\"button btn-cart\\\" href=\\\"<span class=\\\"token prolog\\\">&lt;?php echo $this->getAddToCartUrl($_product) ?></span>\\\">\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token prolog\\\">&lt;?php echo $this->__('Add to Cart') ?></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>span</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>a</span><span class=\\\"token punctuation\\\">></span></span>\\n</code></pre>\\n      </div>\\n<p>Header's menu will also not drop it's submenu, but why not replace it with a <a href=\\\"http://codepen.io/search?q=mega+menu&#x26;limit=all&#x26;depth=everything&#x26;show_forks=false\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">CSS strictly mega menu</a>?</p>\\n<p>So keep in mind that you may have other files that may disfunction. Find what those files are and figure out how to remove it's Magento JS dependencies.</p>\\n<p>Removing Magento's JS and all it's dependencies from your theme completely will absolutely be the wisest road to take. But it's trivial and will cost you time and effort. Start small.</p>\\n<p>The new RWD theme follows the same philosophy but it has more widgets (newsletter subscription form on the footer). So be careful there too.</p>\\n<p>The results? Well we certainly got rid of 12 (~500K) Javascript files and more importantly from our home page, where we may have fancy jQuery sliders and other mambo jambo tricks. Also Magento loads these scripts in the HEAD of our tree which blocks the rendering of the rest of our page. Only pros here!</p>\\n<p>Hit me on <a href=\\\"http://twitter.com/kbariotis\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Twitter</a> if you have similar technics that you use and want to share.</p>\",\"excerpt\":\"Magento comes with a lot of Javascript. It uses  Prototype.js ,  Scriptaculus  and custom libraries written be the Varien people. No doubt…\",\"frontmatter\":{\"date\":\"December 14, 2014\",\"path\":\"/removing-js-scripts-from-cms-pages/\",\"tags\":\"magento, prototype.js, cms, loadtime, performance\",\"title\":\"Removing JS from Magento CMS Pages\",\"draft\":null}}},\"pathContext\":{\"prev\":{\"excerpt\":\"Recently,  Thanos  got me into  JWT . Json Web Token is the modern way of authenticating between your REST API and a web/mobile/native client without using Sessions and/or cookies. This is a nice explanation of how things were  done , until Json Web…\",\"html\":\"<p>Recently, <a href=\\\"http://attheo.do\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Thanos</a> got me into <a href=\\\"http://jwt.io\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">JWT</a>. Json Web Token is the modern way of authenticating between your REST API and a web/mobile/native client without using Sessions and/or cookies. This is a nice explanation of how things were <a href=\\\"http://stackoverflow.com/questions/15051712/how-to-do-authentication-with-a-rest-api-right-browser-native-clients\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">done</a>, until Json Web Tokens came into place.</p>\\n<p>What we can achieve with JWT is really simple: we are getting rid of cookies and sessions while the user's info is completely hidden within the request's header to the server.</p>\\n<p>Upon login, the server returns an encrypted token which, among other info, contains the user identifier. This identifier, which happens to be application specific, is then decrypted by the server at any moment required, which is what enables the server to know who's on the other end of the line.</p>\\n<p>Let's crack it down.</p>\\n<p>First we need a JWT Header like this</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code><span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token property\\\">\\\"typ\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token string\\\">\\\"JWT\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"alg\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token string\\\">\\\"HS256\\\"</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>which says that the JWT is going to be digitaly signed using the HS256 algorithm.\\nBase64url this and you have the first piece of your JWT, namely the Header.\\n<code>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9</code></p>\\n<p>Now we need our actual message that we are going to transmit, namely the Payload.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code><span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token property\\\">\\\"iss\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token string\\\">\\\"joe\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"exp\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token number\\\">1300819380</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"http://example.com/is_root\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Yeap. Plain JSON where you can put anything you want. <code>iss</code> and <code>exp</code> are defined by the <a href=\\\"http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-06#section-4.1\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">specs</a> so you can easily use open source libraries. <code>exp</code> for example stands for Expiration Time in UNIX Timestamp and common libraries know that.</p>\\n<p>Base64url this and we have our second part.\\n<code>eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</code></p>\\n<p>Now since we choose the HS256 algorithm of our signature, we are going to concatenate our Header and Payload and sign them with the HS256 algorithm using a secret key. This is what gives us the Signature.</p>\\n<p>Concatenate all of them together, using dots and we have our JSON Web Token(without the break lines).</p>\\n<p><code>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9 . eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ . dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</code></p>\\n<p>So, now you can store this piece of string on the client using <a href=\\\"https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Storage\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">modern Client Storage mechanisms</a>, and send it to your server on every request. And your server will understand who you are. No more sessions, no more cookies.</p>\\n<p>Last but not least, make sure that you are using a secure connection with your server, since if that token is stolen, through Man In The Middle Attack, anyone can use it.</p>\\n<p>The <a href=\\\"http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-06\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">specs</a> are really simple and you can get into it right away.</p>\\n<p>Further reading:</p>\\n<ul>\\n<li>\\n<p><a href=\\\"https://auth0.com/blog/2014/01/07/angularjs-authentication-with-cookies-vs-token/\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Cookies vs Tokens. Getting auth right with Angular.JS</a></p>\\n</li>\\n<li>\\n<p><a href=\\\"http://angular-tips.com/blog/2014/05/json-web-tokens-examples/\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Json Web Tokens: Examples</a></p>\\n</li>\\n<li>\\n<p><a href=\\\"http://jwt.io/#libraries\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">OS Libraries</a></p>\\n</li>\\n</ul>\",\"id\":\"/home/travis/build/kbariotis/kostasbariotis.com/blog/jwt-the-modern-way-of-authenticating/index.md absPath of file >>> MarkdownRemark\",\"timeToRead\":3,\"frontmatter\":{\"date\":\"2015-01-08T18:51:28.000Z\",\"path\":\"/jwt-the-modern-way-of-authenticating/\",\"tags\":\"jwt, rest, apis, authentication, spa\",\"title\":\"JWT: The modern way of authenticating\",\"draft\":null}},\"next\":{\"excerpt\":\"Hasn't been a long time when i started working with  Wearetech.io  and my first challenge was on. Sweet! If you want to learn more about Wearetech.io, check the  site  and our  Github repo . Now on the fun part. We have a use case where an individual…\",\"html\":\"<p>Hasn't been a long time when i started working with <a title=\\\"Wearetech.io\\\" href=\\\"http://wearetech.io\\\" target=\\\"_blank\\\">Wearetech.io</a> and my first challenge was on. Sweet!</p>\\n<p>If you want to learn more about Wearetech.io, check the <a title=\\\"Wearetech.io\\\" href=\\\"http://wearetech.io\\\" target=\\\"_blank\\\">site</a> and our <a title=\\\"Wearetech.io on Github\\\" href=\\\"https://github.com/WeAreTech/wearetech.io\\\" target=\\\"_blank\\\">Github repo</a>.</p>\\n<p>Now on the fun part. We have a use case where an individual would be able to register on our site as a City Curator.</p>\\n<p>He could search for his City and if he wouldn’t find it in our database he would register it. When the next candidate comes in, he searches for his place and if it would be inside a 10 kilometers range of an already registered city we would deny it, since we wouldn’t want to have city calendars overlapping with each other.</p>\\n<p>When <a title=\\\"Thanasis Polychronakis on Twitter\\\" href=\\\"http://twitter.com/thanpolas\\\" target=\\\"_blank\\\">Thanasis </a>started building Wearetech.io he decided to go with MongoDB. So in order to create the above scenario, <a title=\\\"MongoDB Geospatial Queries\\\" href=\\\"http://docs.mongodb.org/manual/applications/geospatial-indexes/\\\" target=\\\"_blank\\\">MongoDB Geospatial Queries</a> to the rescue!</p>\\n<p>MongoDB supports two types of <a title=\\\"Geospatial Queries on Wikipedia\\\" href=\\\"http://en.wikipedia.org/wiki/Spatial_query\\\" target=\\\"_blank\\\">Geospatial Queries</a> indexing.</p>\\n<ul>\\n\\t<li>The spherical (<a title=\\\"2dSphere Indexes on MongoDB\\\" href=\\\"http://docs.mongodb.org/manual/core/2dsphere/\\\" target=\\\"_blank\\\">2dSphere</a>), that would allow you to store shapes made of points (coordinates) and then make comparisons with them like intersection, etc.</li>\\n\\t<li>The flat (<a title=\\\"2d indexes on MongoDB\\\" href=\\\"http://docs.mongodb.org/manual/core/2d/\\\" target=\\\"_blank\\\">2d</a>), that would store single points and then come up with their distances.</li>\\n</ul>\\nYour choice will affect your development a lot down the road, so think wisely.\\n<p>Now on the code side, we will use Mongoose to shape our models. Here's the most simple one.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">var</span> mongoose     <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongoose'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> Schema     <span class=\\\"token operator\\\">=</span> mongoose<span class=\\\"token punctuation\\\">.</span>Schema<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> CitySchema   <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Schema</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  name<span class=\\\"token punctuation\\\">:</span> String<span class=\\\"token punctuation\\\">,</span>\\n  geo<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    type<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>Number<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n    index<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'2d'</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> mongoose<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">model</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'City'</span><span class=\\\"token punctuation\\\">,</span> CitySchema<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>Now we can start populating our DB like this</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">var</span> City <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./app/models/city'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> cityModel     <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">City</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> \\ncityModel<span class=\\\"token punctuation\\\">.</span>name <span class=\\\"token operator\\\">=</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>name<span class=\\\"token punctuation\\\">;</span> \\ncityModel<span class=\\\"token punctuation\\\">.</span>geo    <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>lat<span class=\\\"token punctuation\\\">,</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>lng <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span> \\n\\ncityModel<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">save</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>And now on the fun part</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">var</span> distance <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">1000</span> <span class=\\\"token operator\\\">/</span> <span class=\\\"token number\\\">6371</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> query <span class=\\\"token operator\\\">=</span> City<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">findOne</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token string\\\">'geo'</span><span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n  $near<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n    req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>lat<span class=\\\"token punctuation\\\">,</span>\\n    req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>lng\\n  <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n  $maxDistance<span class=\\\"token punctuation\\\">:</span> distance\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nquery<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">exec</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> city<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">throw</span> err<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>city<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Cant save: Found city:'</span> <span class=\\\"token operator\\\">+</span> city<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span>city<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n <span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>Our distance is in radians metric system and you can find more on how to calculate it <a title=\\\"Convert to radians\\\" href=\\\"http://docs.mongodb.org/manual/tutorial/calculate-distances-using-spherical-geometry-with-2d-geospatial-indexes/\\\" target=\\\"_blank\\\">here</a>.</p>\\n<p><em>Due to recent Heroku pricing changes, this demo has broke. Still haven't find the time to fix it. :(</em>\\nHere is a <a title=\\\"MongoDB Geospatial Queries PoC\\\" href=\\\"https://damp-everglades-7521.herokuapp.com/\\\" target=\\\"_blank\\\">demo </a>of it. Try searching your City. If it's available register it and then try to find a place inside a 10 kilometers range of your previeus registered City.</p>\\n<p>Hope you will find it interesting. Comments?</p>\",\"id\":\"/home/travis/build/kbariotis/kostasbariotis.com/blog/geospatial-query-with-mongodb-and-node-js/index.md absPath of file >>> MarkdownRemark\",\"timeToRead\":2,\"frontmatter\":{\"date\":\"2014-10-30T18:16:00.000Z\",\"path\":\"/geospatial-query-with-mongodb-and-node-js/\",\"tags\":\"node.js, mongodb, wearetech.io\",\"title\":\"Geospatial Query with MongoDB and Node.js\",\"draft\":null}}}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---removing-js-scripts-from-cms-pages-1557ff6dafeab204b597.js","module.exports = {\"data\":{\"file\":{\"childImageSharp\":{\"sizes\":{\"base64\":\"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAGQABAQADAQAAAAAAAAAAAAAAAAQBAgUD/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwIB/9oADAMBAAIQAxAAAAGXEfnO2KxXytBY6QBP/8QAGxAAAgIDAQAAAAAAAAAAAAAAAQIDEQASIiH/2gAIAQEAAQUC2qMsrDRjkh7U+9ZIKYC8jNp//8QAFxEBAAMAAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPwFlQ//EABkRAAEFAAAAAAAAAAAAAAAAAAABECExQf/aAAgBAgEBPwGWwWz/xAAbEAACAgMBAAAAAAAAAAAAAAAAEQEhAxAxgf/aAAgBAQAGPwK2dsYo5BBWReaRB//EABwQAAICAwEBAAAAAAAAAAAAAAERACExQVFhcf/aAAgBAQABPyHzg5KmRyuAZAwYJ2aHFOw5Qmlybntx2y3CnEl/Z//aAAwDAQACAAMAAAAQOyi8/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAERMUH/2gAIAQMBAT8QUXCB6YR//8QAGhEAAgIDAAAAAAAAAAAAAAAAAAERMSFBsf/aAAgBAgEBPxByVkzvonYxY//EAB0QAQEAAwACAwAAAAAAAAAAAAERACFBMVFhcbH/2gAIAQEAAT8Q6uhuUW+P3HKhIpbqr8JMNj2KrvBpVoF3uLYUDX3imLRSGt4ck1onhy7wNT0XD24jIs1n/9k=\",\"aspectRatio\":0.9657118055555556,\"src\":\"/static/avatar-820706df6fdb07a9b021a790449fec17-381d6.jpg\",\"srcSet\":\"/static/avatar-820706df6fdb07a9b021a790449fec17-62f05.jpg 200w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-dc2b4.jpg 400w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-381d6.jpg 800w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-e5d70.jpg 1200w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-d14e0.jpg 1600w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-9cc71.jpg 2225w\",\"srcWebp\":\"/static/avatar-820706df6fdb07a9b021a790449fec17-fefde.webp\",\"srcSetWebp\":\"/static/avatar-820706df6fdb07a9b021a790449fec17-5eed2.webp 200w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-68e3c.webp 400w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-fefde.webp 800w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-300fe.webp 1200w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-ed5bd.webp 1600w,\\n/static/avatar-820706df6fdb07a9b021a790449fec17-9442a.webp 2225w\",\"sizes\":\"(max-width: 800px) 100vw, 800px\"}}},\"site\":{\"siteMetadata\":{\"title\":\"Kostas Bariotis' Blog\",\"description\":\"I am Kostas Bariotis, a web developer, a proud wanderer and a passionate doer. My mission is to write clean and efficient code, to solve problems on the web and to learn something more.\",\"siteUrl\":\"https://kostasbariotis.com\"}},\"markdownRemark\":{\"html\":\"<p>Magento comes with a lot of Javascript. It uses <a href=\\\"http://prototypejs.org/\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Prototype.js</a>, <a href=\\\"https://github.com/madrobby/scriptaculous\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Scriptaculus</a> and custom libraries written be the Varien people. No doubt that these libraries are old and I hardly use 'em on my themes, but they are very tight to the Magento theme ecosystem and we should be careful when we mess with them.</p>\\n<p>A modern website's home page is very important and we should focus at it's load time a lot. Magento's home page is indeed a CMS page and loads some of those scripts there too.</p>\\n<p>Magento Layout's system has also done a nice job when it comes to what scripts to load where. Something that bothers me is the load of these scripts on CMS pages where by my experience they are not so useful there except from some standard places.</p>\\n<p>So what we do? Say we created our <a href=\\\"http://www.magentocommerce.com/wiki/4_-_themes_and_template_customization/0_-_theming_in_magento/designing-for-magento\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">custom theme</a>. Let's remove those script completely from CMS pages including our home page, which is a CMS page.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-xml\\\"><code><span class=\\\"token prolog\\\">&lt;?xml version=\\\"1.0\\\"?></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>layout</span> <span class=\\\"token attr-name\\\">version</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>0.1.0<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>cms_page</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>reference</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>root<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>reference</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>head<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>prototype/prototype.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>lib/ccard.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>prototype/validation.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/builder.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/effects.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/dragdrop.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/controls.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>scriptaculous/slider.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>varien/js.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>varien/form.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>varien/menu.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>action</span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>removeItem<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>type</span><span class=\\\"token punctuation\\\">></span></span>js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>type</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>name</span><span class=\\\"token punctuation\\\">></span></span>mage/translate.js<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>name</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>action</span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>reference</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>reference</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>cms_page</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>layout</span><span class=\\\"token punctuation\\\">></span></span>\\n</code></pre>\\n      </div>\\n<p>But now we are going to have problems and Dev Console will turn red. Some blocks are not functioning.</p>\\n<p>First the search block on top of our page. It's a form that uses the Validation module and also the Autocomplete feature. Let's remove those by opening the <code>catalogsearch/form.mini.phtml</code> file (after we have copied it on our theme's folder) and remove the <code>&#x3C;script>...&#x3C;/script></code>.</p>\\n<p>We also have the Translator, which translates Javascript strings. We don't going to need it either on our CMS pages. We open <code>page/html/head.phtml</code> and we are removing the <code>&#x3C;?php echo $this->helper('core/js')->getTranslatorScript() ?></code> definition.</p>\\n<p>But that's not all. A lot of widgets that we may have include on our CMS pages, may use some Javascript as well. The new products list widgets, which is located at <code>catalog/product/widget/new/content/new.[list|grid].phtml</code> uses the <code>setLocation</code> function for the Add To Card button. Let's remove that by replacing the button with an anchor. Like this:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code>&lt;a title=\\\"<span class=\\\"token prolog\\\">&lt;?php echo $this->__('Add to Cart') ?></span>\\\" class=\\\"button btn-cart\\\" href=\\\"<span class=\\\"token prolog\\\">&lt;?php echo $this->getAddToCartUrl($_product) ?></span>\\\">\\n\\t<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token prolog\\\">&lt;?php echo $this->__('Add to Cart') ?></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>span</span><span class=\\\"token punctuation\\\">></span></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>a</span><span class=\\\"token punctuation\\\">></span></span>\\n</code></pre>\\n      </div>\\n<p>Header's menu will also not drop it's submenu, but why not replace it with a <a href=\\\"http://codepen.io/search?q=mega+menu&#x26;limit=all&#x26;depth=everything&#x26;show_forks=false\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">CSS strictly mega menu</a>?</p>\\n<p>So keep in mind that you may have other files that may disfunction. Find what those files are and figure out how to remove it's Magento JS dependencies.</p>\\n<p>Removing Magento's JS and all it's dependencies from your theme completely will absolutely be the wisest road to take. But it's trivial and will cost you time and effort. Start small.</p>\\n<p>The new RWD theme follows the same philosophy but it has more widgets (newsletter subscription form on the footer). So be careful there too.</p>\\n<p>The results? Well we certainly got rid of 12 (~500K) Javascript files and more importantly from our home page, where we may have fancy jQuery sliders and other mambo jambo tricks. Also Magento loads these scripts in the HEAD of our tree which blocks the rendering of the rest of our page. Only pros here!</p>\\n<p>Hit me on <a href=\\\"http://twitter.com/kbariotis\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Twitter</a> if you have similar technics that you use and want to share.</p>\",\"excerpt\":\"Magento comes with a lot of Javascript. It uses  Prototype.js ,  Scriptaculus  and custom libraries written be the Varien people. No doubt…\",\"frontmatter\":{\"date\":\"December 14, 2014\",\"path\":\"/removing-js-scripts-from-cms-pages/\",\"tags\":\"magento, prototype.js, cms, loadtime, performance\",\"title\":\"Removing JS from Magento CMS Pages\",\"draft\":null}}},\"pathContext\":{\"prev\":{\"excerpt\":\"Recently,  Thanos  got me into  JWT . Json Web Token is the modern way of authenticating between your REST API and a web/mobile/native client without using Sessions and/or cookies. This is a nice explanation of how things were  done , until Json Web…\",\"html\":\"<p>Recently, <a href=\\\"http://attheo.do\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Thanos</a> got me into <a href=\\\"http://jwt.io\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">JWT</a>. Json Web Token is the modern way of authenticating between your REST API and a web/mobile/native client without using Sessions and/or cookies. This is a nice explanation of how things were <a href=\\\"http://stackoverflow.com/questions/15051712/how-to-do-authentication-with-a-rest-api-right-browser-native-clients\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">done</a>, until Json Web Tokens came into place.</p>\\n<p>What we can achieve with JWT is really simple: we are getting rid of cookies and sessions while the user's info is completely hidden within the request's header to the server.</p>\\n<p>Upon login, the server returns an encrypted token which, among other info, contains the user identifier. This identifier, which happens to be application specific, is then decrypted by the server at any moment required, which is what enables the server to know who's on the other end of the line.</p>\\n<p>Let's crack it down.</p>\\n<p>First we need a JWT Header like this</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code><span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token property\\\">\\\"typ\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token string\\\">\\\"JWT\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"alg\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token string\\\">\\\"HS256\\\"</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>which says that the JWT is going to be digitaly signed using the HS256 algorithm.\\nBase64url this and you have the first piece of your JWT, namely the Header.\\n<code>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9</code></p>\\n<p>Now we need our actual message that we are going to transmit, namely the Payload.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code><span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token property\\\">\\\"iss\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token string\\\">\\\"joe\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"exp\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token number\\\">1300819380</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"http://example.com/is_root\\\"</span><span class=\\\"token operator\\\">:</span><span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>Yeap. Plain JSON where you can put anything you want. <code>iss</code> and <code>exp</code> are defined by the <a href=\\\"http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-06#section-4.1\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">specs</a> so you can easily use open source libraries. <code>exp</code> for example stands for Expiration Time in UNIX Timestamp and common libraries know that.</p>\\n<p>Base64url this and we have our second part.\\n<code>eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</code></p>\\n<p>Now since we choose the HS256 algorithm of our signature, we are going to concatenate our Header and Payload and sign them with the HS256 algorithm using a secret key. This is what gives us the Signature.</p>\\n<p>Concatenate all of them together, using dots and we have our JSON Web Token(without the break lines).</p>\\n<p><code>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9 . eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ . dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</code></p>\\n<p>So, now you can store this piece of string on the client using <a href=\\\"https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Storage\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">modern Client Storage mechanisms</a>, and send it to your server on every request. And your server will understand who you are. No more sessions, no more cookies.</p>\\n<p>Last but not least, make sure that you are using a secure connection with your server, since if that token is stolen, through Man In The Middle Attack, anyone can use it.</p>\\n<p>The <a href=\\\"http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-06\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">specs</a> are really simple and you can get into it right away.</p>\\n<p>Further reading:</p>\\n<ul>\\n<li>\\n<p><a href=\\\"https://auth0.com/blog/2014/01/07/angularjs-authentication-with-cookies-vs-token/\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Cookies vs Tokens. Getting auth right with Angular.JS</a></p>\\n</li>\\n<li>\\n<p><a href=\\\"http://angular-tips.com/blog/2014/05/json-web-tokens-examples/\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Json Web Tokens: Examples</a></p>\\n</li>\\n<li>\\n<p><a href=\\\"http://jwt.io/#libraries\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">OS Libraries</a></p>\\n</li>\\n</ul>\",\"id\":\"/home/travis/build/kbariotis/kostasbariotis.com/blog/jwt-the-modern-way-of-authenticating/index.md absPath of file >>> MarkdownRemark\",\"timeToRead\":3,\"frontmatter\":{\"date\":\"2015-01-08T18:51:28.000Z\",\"path\":\"/jwt-the-modern-way-of-authenticating/\",\"tags\":\"jwt, rest, apis, authentication, spa\",\"title\":\"JWT: The modern way of authenticating\",\"draft\":null}},\"next\":{\"excerpt\":\"Hasn't been a long time when i started working with  Wearetech.io  and my first challenge was on. Sweet! If you want to learn more about Wearetech.io, check the  site  and our  Github repo . Now on the fun part. We have a use case where an individual…\",\"html\":\"<p>Hasn't been a long time when i started working with <a title=\\\"Wearetech.io\\\" href=\\\"http://wearetech.io\\\" target=\\\"_blank\\\">Wearetech.io</a> and my first challenge was on. Sweet!</p>\\n<p>If you want to learn more about Wearetech.io, check the <a title=\\\"Wearetech.io\\\" href=\\\"http://wearetech.io\\\" target=\\\"_blank\\\">site</a> and our <a title=\\\"Wearetech.io on Github\\\" href=\\\"https://github.com/WeAreTech/wearetech.io\\\" target=\\\"_blank\\\">Github repo</a>.</p>\\n<p>Now on the fun part. We have a use case where an individual would be able to register on our site as a City Curator.</p>\\n<p>He could search for his City and if he wouldn’t find it in our database he would register it. When the next candidate comes in, he searches for his place and if it would be inside a 10 kilometers range of an already registered city we would deny it, since we wouldn’t want to have city calendars overlapping with each other.</p>\\n<p>When <a title=\\\"Thanasis Polychronakis on Twitter\\\" href=\\\"http://twitter.com/thanpolas\\\" target=\\\"_blank\\\">Thanasis </a>started building Wearetech.io he decided to go with MongoDB. So in order to create the above scenario, <a title=\\\"MongoDB Geospatial Queries\\\" href=\\\"http://docs.mongodb.org/manual/applications/geospatial-indexes/\\\" target=\\\"_blank\\\">MongoDB Geospatial Queries</a> to the rescue!</p>\\n<p>MongoDB supports two types of <a title=\\\"Geospatial Queries on Wikipedia\\\" href=\\\"http://en.wikipedia.org/wiki/Spatial_query\\\" target=\\\"_blank\\\">Geospatial Queries</a> indexing.</p>\\n<ul>\\n\\t<li>The spherical (<a title=\\\"2dSphere Indexes on MongoDB\\\" href=\\\"http://docs.mongodb.org/manual/core/2dsphere/\\\" target=\\\"_blank\\\">2dSphere</a>), that would allow you to store shapes made of points (coordinates) and then make comparisons with them like intersection, etc.</li>\\n\\t<li>The flat (<a title=\\\"2d indexes on MongoDB\\\" href=\\\"http://docs.mongodb.org/manual/core/2d/\\\" target=\\\"_blank\\\">2d</a>), that would store single points and then come up with their distances.</li>\\n</ul>\\nYour choice will affect your development a lot down the road, so think wisely.\\n<p>Now on the code side, we will use Mongoose to shape our models. Here's the most simple one.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">var</span> mongoose     <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongoose'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> Schema     <span class=\\\"token operator\\\">=</span> mongoose<span class=\\\"token punctuation\\\">.</span>Schema<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> CitySchema   <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Schema</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n  name<span class=\\\"token punctuation\\\">:</span> String<span class=\\\"token punctuation\\\">,</span>\\n  geo<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    type<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>Number<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n    index<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'2d'</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> mongoose<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">model</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'City'</span><span class=\\\"token punctuation\\\">,</span> CitySchema<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>Now we can start populating our DB like this</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">var</span> City <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./app/models/city'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> cityModel     <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">City</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> \\ncityModel<span class=\\\"token punctuation\\\">.</span>name <span class=\\\"token operator\\\">=</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>name<span class=\\\"token punctuation\\\">;</span> \\ncityModel<span class=\\\"token punctuation\\\">.</span>geo    <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>lat<span class=\\\"token punctuation\\\">,</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>lng <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span> \\n\\ncityModel<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">save</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n  res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>And now on the fun part</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code><span class=\\\"token keyword\\\">var</span> distance <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">1000</span> <span class=\\\"token operator\\\">/</span> <span class=\\\"token number\\\">6371</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> query <span class=\\\"token operator\\\">=</span> City<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">findOne</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token string\\\">'geo'</span><span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n  $near<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n    req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>lat<span class=\\\"token punctuation\\\">,</span>\\n    req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>lng\\n  <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n  $maxDistance<span class=\\\"token punctuation\\\">:</span> distance\\n\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\nquery<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">exec</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> city<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">throw</span> err<span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n\\n  <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>city<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Cant save: Found city:'</span> <span class=\\\"token operator\\\">+</span> city<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span>city<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n <span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n</code></pre>\\n      </div>\\n<p>Our distance is in radians metric system and you can find more on how to calculate it <a title=\\\"Convert to radians\\\" href=\\\"http://docs.mongodb.org/manual/tutorial/calculate-distances-using-spherical-geometry-with-2d-geospatial-indexes/\\\" target=\\\"_blank\\\">here</a>.</p>\\n<p><em>Due to recent Heroku pricing changes, this demo has broke. Still haven't find the time to fix it. :(</em>\\nHere is a <a title=\\\"MongoDB Geospatial Queries PoC\\\" href=\\\"https://damp-everglades-7521.herokuapp.com/\\\" target=\\\"_blank\\\">demo </a>of it. Try searching your City. If it's available register it and then try to find a place inside a 10 kilometers range of your previeus registered City.</p>\\n<p>Hope you will find it interesting. Comments?</p>\",\"id\":\"/home/travis/build/kbariotis/kostasbariotis.com/blog/geospatial-query-with-mongodb-and-node-js/index.md absPath of file >>> MarkdownRemark\",\"timeToRead\":2,\"frontmatter\":{\"date\":\"2014-10-30T18:16:00.000Z\",\"path\":\"/geospatial-query-with-mongodb-and-node-js/\",\"tags\":\"node.js, mongodb, wearetech.io\",\"title\":\"Geospatial Query with MongoDB and Node.js\",\"draft\":null}}}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/removing-js-scripts-from-cms-pages.json\n// module id = 624\n// module chunks = 15508496722462"],"sourceRoot":""}